# nikodex2-backend
Backend for Nikodex V2 in Python using FastAPI

## Dependecies
To setup the backend server, you'll need:
- Python 3
- MySQL

## Setup for developing
1. (Recommended) Setup a virtual environment for the project
```bash
python -m venv virtual-env

# only run one of the following commands depending on the OS/shell you're using
source virtual-env/bin/activate # Linux ONLY (bash, zsh, ...)
source virtual-env/bin/activate.fish # Linux ONLY (fish)
virtual-env\Scripts\Activate.ps1 # Windows ONLY (powershell)
virtual-env\Scripts\activate # Windows ONLY (cmd)
```
2. Setup the MySQL database with the provided `server_schema.sql` file.
3. Install all the required dependecies
```bash
pip install -r requirements.txt
pip install "fastapi[standard]" # fastapi command line tool
```
4. Configure the server by creating a .env file with the following content (replace the brackets with actual data):
```
# MySQL server setup.
MYSQL_USER="<mysql_username>"
MYSQL_PASS="<mysql_password>"
MYSQL_URI="<mysql_host_or_url>"
MYSQL_PORT="<mysql_port>"

# you may need to pass in the origin of the front-end server here if it's unable to access the back-end. otherwise, leave it BLANK
FASTAPI_ALLOWED_ORIGIN="<allowed_url_1>,<allowed_url_2>,..."

# Secret key: to be generated by running 'openssl rand -hex 32'
SECRET_KEY="<secret key here>"
ALGORITHM="HS256"

# Path to store the image of Nikosona
IMG_DIR=""
```

5. Run the dev server
```
fastapi dev server.py
```

You can now login to the admin dashboard with the default username and password of `admin` / `nikodex`.

p.s.: If you're planning on using the dev mode for production: **__DON'T__**

## Setup for production
> Follow the same step from 1 to 4 in the [Setup for developing](#setup-for-developing) section
5. Run the production server
```
fastapi run main.py
```
This is the default way to run the backend server, and it should work for most cases.

However, since the backend server is an ASGI app, you can use a different ASGI server program. For instance, you can use gunicorn to run the backend server with options to create more workers
```bash
# FOR UNIX/LINUX ONLY
gunicorn -k uvicorn.workers.UvicornWorker server:app --workers 4 --bind 0.0.0.0:8000
```

6. (IMPORTANT) Change the password!!!
Since the default username and password is the same when you clone the repo, leaving it there would be insecure.

Therefore, we recommend resetting the default password of the admin account. To do so, change the password within the admin dashboard, or use the `account_manage.py` script to edit the default `admin`'s password account.

## Accounts
As of now, there is only one type of account for Nikodex v2, which is Administrator (or admin for short). These accounts have access to the admin dashboard on the front-end, and can manage data about Nikosonas and Blogs on the database.

If you wish to create more admin accounts to manage the Nikodex, use the `account_manage.py` scripts to create, edit, or remove admin accounts.